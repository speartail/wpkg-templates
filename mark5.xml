<package
    id='&id;'
    name='MARK Communication System 5'
    revision='&version;-2&revision;'
    reboot='false'
    priority='10'>

  <depends package-id="dotnet4" />

  <variable name='PKG_VERSION'     value='&version;' />
  <variable name='PKG_SOURCE'      value="%SOFTWARE%\Mark5\%PKG_VERSION%\%PROCESSOR_ARCHITECTURE%\Mark5Install.msi" />
  <variable name='PKG_DESTINATION' value="%PROGRAMFILES%\Mark5" />

  <check type="file" condition="versiongreaterorequal" path="%PKG_DESTINATION%\Mark5.exe" value="%PKG_VERSION%" />

  <install include='remove' />
  <install cmd='msiexec /quiet /norestart /i "%PKG_SOURCE%" /lv* "%TEMP%\wpkg-&id;.log"'
           timeout='600'><exit code='3010' reboot='false' /></install>
  <install cmd='xcopy /Y /I "%SOFTWARE%\Mark5\ConnectionInfo.xml" "%PKG_DESTINATION%" > nul' />

  <upgrade   include='install' />
  <downgrade include='install' />

  <remove cmd='msiexec /quiet /norestart /x "%PKG_SOURCE%"' timeout='300'>
    <exit code='1605' />
    <exit code='3010' reboot='false' />
  </remove>
</package>
